"0",""
"0","## Chapter 2.4"
"0","####################################################"
"0",""
"0","# # read in air temperature data,  compare AET with Average annual air temp"
"0",""
"0","# Package ID: knb-lter-hbr.59.10 Cataloging System:https://pasta.edirepository.org."
"0","# Data set title: Hubbard Brook Experimental Forest: Daily Temperature Record, 1955 - present."
"0","inUrl1  <- ""https://pasta.lternet.edu/package/data/eml/knb-lter-hbr/59/10/9723086870f14b48409869f6c06d6aa8"" "
"0","infile1 <- tempfile()"
"0","try(download.file(inUrl1,infile1,method=""curl""))"
"1","  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
"
"1","                                 Dload  Upload   Total   Spent    Left  Speed
"
"1","  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0 98 3247k   98 3188k    0     0  1507k      0  0:00:02  0:00:02 --:--:-- 1506k100 3247k  100 3247k    0     0  1530k      0  0:00:02  0:00:02 --:--:-- 1530k
"
"0","if (is.na(file.size(infile1))) download.file(inUrl1,infile1,method=""auto"")"
"0",""
"0",""
"0","dt3 <-read.csv(infile1,header=F "
"0","               ,skip=1"
"0","               ,sep="",""  "
"0","               , col.names=c("
"0","                 ""date"",     "
"0","                 ""STA"",     "
"0","                 ""MAX"",     "
"0","                 ""MIN"",     "
"0","                 ""AVE"",     "
"0","                 ""Flag""    ), check.names=TRUE)"
"0",""
"0","unlink(infile1)"
"0",""
"0","# We have a data column, but its not formatted as a date"
"0","dt3$DATE<-ymd(dt3$date) # change how R interprets Date to be a date"
"0","dt3$Year<-year(dt3$DATE)"
"0",""
"0","# add in water year"
"0","w.year <- as.numeric(format(dt3$DATE, ""%Y""))"
"0","june.july.sept <- as.numeric(format(dt3$DATE, ""%m"")) < 6"
"0","w.year[june.july.sept] <- w.year[june.july.sept] - 1"
"0",""
"0","dt3$wyear<-w.year # add water year as a column to precip dataset"
"0","dt3$month<-month(dt3$date)"
"0",""
"0","# add in water year-station"
"0","dt3$wys<-paste(dt3$wyear, dt3$STA)"
"0",""
"0",""
"0","# make sure you are only using complete years for the record"
"0","pre.obs<-as.data.frame(table(dt3$STA , dt3$wyear))"
"0","pre.obs$wys<- paste(pre.obs$Var2, pre.obs$Var1)"
"0","pre.obs[pre.obs$Freq<350, ""Use""]<-""incomplete wyear"" # complete is 350 or more days"
"0","pre.obs[is.na(pre.obs$Use),""Use""]<-""complete"""
"0",""
"0",""
"0","dt3$Use<-pre.obs$Use[match(dt3$wys, pre.obs$wys)]"
"0",""
"0","dt3.complete<-dt3[dt3$Use==""complete"",]"
"0",""
"0","# get annual averages of air"
"0","growseas<-dt3.complete[dt3.complete$month >=""6"" & dt3.complete$month <=9 ,]"
"0","annairgrow<-aggregate(list(avtemp=growseas$AVE), by=list( wyear=growseas$wyear), FUN=""mean"")"
"0",""
"0",""
"0","#visualize to become familiar with data"
"0","ggplot(annairgrow, aes(x=wyear, y=avtemp))+"
"0","  geom_point()+geom_line()+"
"0","  ylab(""Growing season air temperature (C)"")+xlab(""Water year (June 1st)"")+"
"0","  theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())"
