av$Year<-as.integer(av$Year)
av$SEASON<-factor(av$SEASON, levels=c("SPRING","FALL"))
#
ggplot(av, aes(Year))+
geom_ribbon(aes( ymin = DAY-SE, ymax = DAY + SE), fill = "grey70") +
geom_line(aes(x=Year, y = DAY))+facet_wrap(Species~SEASON, ncol=2, scales="free_y")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
geom_point(expav, mapping=aes(x=Year, y=DAY, col=SITE))+
dim(expav)
dim(expav)
dim(expand)
head(expand,50)
head(expav)
head(expav)
#expand<-dt1[dt1$Phenology_Stage==4,]
expand<-dt1
# We have a data column, but its not formatted as a date
expand$DATE<-ymd(expand$DATE) # change how R interprets Date to be a date
expand$Year<-year(expand$DATE)
expand$Day<-day(expand$DATE)
head(expand,20)
# add in water year
w.year <- as.numeric(format(expand$DATE, "%Y"))
june.july.sept <- as.numeric(format(expand$DATE, "%m")) < 6
w.year[june.july.sept] <- w.year[june.july.sept] - 1
expand$wyear<-w.year # add water year as a column to precip dataset
head(expand,50)
#expav<-aggregate(list(DAY=expand$DAY), by=list(SEASON=expand$SEASON, Year=expand$Year, SPECIES=expand$SPECIES, SITE=expand$SITE), FUN="mean", na.rm=T)
expav<-aggregate(list(DAY=expand$DAY), by=list(SEASON=expand$SEASON, Year=expand$Year, SPECIES=expand$SPECIES, SITE=expand$SITE, STAGE=expand$Phenology_Stage), FUN="mean", na.rm=T)
dim(expav)
head(expav)
# We have a data column, but its not formatted as a date
air$DATE<-ymd(air$date) # change how R interprets Date to be a date
air$Year<-year(air$DATE)
expav$seasp<-paste( expav$SPECIES, expav$SEASON)
expav$seasi<-paste( expav$SPECIES, expav$SITE,  expav$SEASON)
head(expav)
# give top bottom code
expav[expav$SITE=="1B","Elevation"]<-"Bottom"
expav[expav$SITE=="4B","Elevation"]<-"Bottom"
expav[expav$SITE=="5B","Elevation"]<-"Bottom"
expav[expav$SITE=="7B","Elevation"]<-"Bottom"
expav[expav$SITE=="4T","Elevation"]<-"Top"
expav[expav$SITE=="5T","Elevation"]<-"Top"
expav[expav$SITE=="6T","Elevation"]<-"Top"
expav[expav$SITE=="7T","Elevation"]<-"Top"
expav[expav$SITE=="HQ","Elevation"]<-"HQ"
expav$Elevation<-factor(expav$Elevation, levels=c("Top","Bottom","HQ"))
table(expav$SPECIES)
expav[expav$SPECIES=="ACSA3", "Species"]<-"Sugar maple"
expav[expav$SPECIES=="BEAL2", "Species"]<-"Yellow birch"
expav[expav$SPECIES=="FAGR", "Species"]<-"American beech"
expav$SEASON<-factor(expav$SEASON, levels=c("SPRING","FALL"))
head(expav)
table(expav$STAGE)
head(expav)
ggplot(expav, aes(x=STAGE, y=DAY, col=SPECIES))+geom_point()
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+facet_wrap(~SPECIES)
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+facet_grid(SEASON~SPECIES)
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+
facet_grid(SEASON~SPECIES, scales="free_y")
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+
facet_grid(SEASON~Species, scales="free_y")
head(expav)
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_grid(SEASON~Species, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_grid(Species~SEASON, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth()
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_boxplot()+
facet_wrap(~Species, scales="free_y")
point
ggplot(expav, aes(x=STAGE, y=DAY, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y")
av<-aggregate(list(DAY=expav$DAY), by=list(Year=expav$Year, SEASON=expav$SEASON, Species=expav$Species), FUN="mean")
st.err <- function(x) {  sd(x)/sqrt(length(x))}
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(expav, aes(x=Year, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=Year))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=STAGE))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE))+geom_point()+
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
table(expav$STAGE)
table(expav$STAGE)
table(expand$STAGE)
table(expand$Phenology_Stage)
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Season, scales="free_y")
head(expav)
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~SEASON, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(expav, aes(x=Year, y=DAY,group=STAGE, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
sta2<-expav[expav$STAGE==2,]
ggplot(sta2, aes(x=Year, y=DAY,col=Species)+geom_point()+
ggplot(sta2, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(sta2, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
head(sta2)
ggplot(sta2, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(sta2, aes(x=Year, y=DAY,col=Species, group=seasi))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(sta2, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
sta3<-expav[expav$STAGE==3,]
ggplot(sta3, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(sta3, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)
### add julian day of year / month?
as.Date(expav$DAY,    # Convert Julian day to date
origin = as.Date(paste0("expav$Year"-01-01)))
paste0("expav$Year"-01-01)
paste0("expav$Year","-01-01")
paste0(expav$Year,"-01-01")
### add julian day of year / month?
as.Date(expav$DAY,    # Convert Julian day to date
origin = as.Date(paste0(expav$Year,"-01-01")))
### add julian day of year / month?
expav$Date<-as.Date(expav$DAY,    # Convert Julian day to date
origin = as.Date(paste0(expav$Year,"-01-01")))
ggplot(sta2, aes(x=Year, y=Date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()
ggplot(sta2, aes(x=Year, y=Date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_continuous()
ggplot(sta2, aes(x=Year, y=Date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()
str(sta2)
sta2<-expav[expav$STAGE==2,]
str(sta2)
ggplot(sta2, aes(x=Year, y=Date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()
expav$date<-as.Date(expav$DAY)
expav$date<-as.Date(expav$DAY, origin=2020)
expav$date<-as.Date(expav$DAY, origin=as.Date(2020))
expav$date<-as.Date(expav$DAY, origin=as.Date("2020-01-01"))
sta2<-expav[expav$STAGE==2,]
ggplot(sta2, aes(x=Year, y=ldate,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()+theme_classic()
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth()+
scale_y_date()+theme_bw()
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")
ggplot(sta3, aes(x=Year, y=DAY,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
sta3<-expav[expav$STAGE==3,]
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=Species, group=seasi))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=Species, group=seasi))+geom_point()+
facet_wrap(SITE~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(Species~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(SEASON~Species, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=YEAR))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
#########
### add julian day of year / month?
expav$Date<-as.Date(expav$DAY,    # Convert Julian day to date
origin = as.Date(paste0(expav$Year,"-01-01")))
expav$date<-as.Date(expav$DAY, origin=as.Date("2020-01-01"))
sta2<-expav[expav$STAGE==2,]
str(sta2)
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
sta3<-expav[expav$STAGE==3,]
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(SEASON~Species, scales="free_y", nrow=2)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(Species~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_grid(Species~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_grid(Species~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_grid(Species~SEASON, scales="free_y")+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_grid(Species~SEASON, scales="free")+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(Species~SEASON, scales="free")+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(SEASON~Species, scales="free")+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(SEASON~Species, scales="free", nrow=3)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(Species~SEASON, scales="free", nrow=3)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
ggplot(sta2, aes(x=Year, y=date,col=Species, shape=SITE))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
sta3<-expav[expav$STAGE==3,]
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(Species~SEASON, scales="free", nrow=3)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, scales="free", nrow=3)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, scales="free", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 week", date_labels = "%W")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%M")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%m")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_minor_breaks = "1 month")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=3)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(sta3, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(sta3, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free", nrow=1)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(STAGE~SEASON, scales="free", nrow=1)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
expav$stage<-floor(expav$STAGE)
head(expav)
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(stage~SEASON, scales="free", nrow=1)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(~stage, scales="free", nrow=1)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(~stage, scales="free", nrow=5)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(SEASON~stage, scales="free", nrow=5)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(stage~SEASON, scales="free", nrow=5)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year))+geom_point()+
facet_wrap(~Species,nrow=3, scales="free_y")
ggplot(expav, aes(x=Year, y=DAY, col=as.factor(STAGE)))+geom_point()+
facet_wrap(~Species, scales="free_y")
#########
### add julian day of year / month?
expav$Date<-as.Date(expav$DAY,    # Convert Julian day to date
origin = as.Date(paste0(expav$Year,"-01-01")))
expav$date<-as.Date(expav$DAY, origin=as.Date("2020-01-01"))
sta2<-expav[expav$STAGE==2,]
str(sta2)
ggplot(sta2, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 2")+ylab("Calendar date")
sta3<-expav[expav$STAGE==3,]
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
expav$stage<-floor(expav$STAGE)
head(expav)
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(stage~SEASON, scales="free", nrow=5)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")
### with sites
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")
ggplot(expav, aes(x=DAY, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth(, se=F)
ggplot(expav, aes(x=date, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth( se=F)
ggplot(expav, aes(x=date, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth( se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(expav, aes(x=date, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, scales="free_y", nrow=3)+
geom_smooth( se=F)+
scale_x_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(expav, aes(x=date, y=STAGE, col=Year, group=Year))+geom_point()+
facet_wrap(~Species, nrow=3)+
geom_smooth( se=F)+
scale_x_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
### with sites
ggplot(sta3, aes(x=Year, y=date,col=SITE, group=seasi))+geom_point()+
facet_wrap(~Species, nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date(date_breaks = "1 month", date_labels = "%b")+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+geom_line()
ggplot(expav, aes(x=date, y=Year,col=Species))+geom_point()+
facet_wrap(stage~SEASON, scales="free", nrow=5)+geom_smooth(method="lm",se=F)+
scale_x_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line()
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line()
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=seasi))
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=seasp))
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=seasi))
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=SITE))
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=seasp))
ggplot(sta3, aes(x=Year, y=date,col=Species))+geom_point()+
facet_wrap(~SEASON, scales="free_y", nrow=1)+geom_smooth(method="lm",se=F)+
scale_y_date()+theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ggtitle("Phenology stage 3")+ylab("Calendar date")+
geom_line(aes(group=seasi))
