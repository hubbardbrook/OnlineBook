ggtitle(" ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Steamwater Ca - Precip Ca (g / ha)")
inoutca<-ggplot(annCa_precip_WS6, aes(x=wyear, y=outin))+geom_point()+geom_line()+
ggtitle(" ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Steamwater Ca - Precip Ca (g / ha)")
pinoutca<-ggplotly(ginputcapinoutca)
pinoutca<-ggplotly(pinoutca)
inoutca<-ggplot(annCa_precip_WS6, aes(x=wyear, y=outin))+geom_point()+geom_line()+
ggtitle(" ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Steamwater Ca - Precip Ca (g / ha)")
pinoutca<-ggplotly(inoutca)
pinoutca
ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=annCa_precip_WS6))+geom_point()+geom_line()+
ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha))+geom_point()+geom_line()+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
ylab("Steamwater Ca - Precip Ca (g / ha)
ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle(" ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
pinoutca<-ggplotly(inoutca)
pinoutca
ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle(" ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
pinoutca<-ggplotly(strpre)
stpe<-ggplotly(strpre)
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
stpe<-ggplotly(strpre)
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+geom_line()+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
stpe<-ggplotly(strpre)
stpe
strpre
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Streamwater")+
ylab("Precip")
stpe<-ggplotly(strpre)
stpe
## Chapter 3.1
####################################################
# read in monthly fluxes for Chemistry of streamwater data for WS6
# Package ID: knb-lter-hbr.8.17 Cataloging System:https://pasta.edirepository.org.
# Data set title: Hubbard Brook Experimental Forest: Chemistry of Streamwater â Monthly Fluxes, Watershed 6, 1963 - present.
inUrl1  <- "https://pasta.lternet.edu/package/data/eml/knb-lter-hbr/8/17/3312389e77cc5fd06bc8a7c9019de0ed"
infile1 <- tempfile()
try(download.file(inUrl1,infile1,method="curl"))
if (is.na(file.size(infile1))) download.file(inUrl1,infile1,method="auto")
dt4 <-read.csv(infile1,header=F
,skip=1
,sep=","
,quot='"'
, col.names=c(
"Year",
"Month",
"Year_Month",
"flow_mm",
"Ca_flux",
"Mg_flux",
"K_flux",
"Na_flux",
"Al_Ferron_flux",
"TMAl_flux",
"OMAl_flux",
"Al_ICP_flux",
"NH4_flux",
"SO4_flux",
"NO3_flux",
"Cl_flux",
"PO4_flux",
"DOC_flux",
"TDN_flux",
"DON_flux",
"DIC_flux",
"SiO2_flux",
"Mn_flux",
"Fe_flux",
"F_flux",
"H_flux",
"pH_volwt",
"SpecCond_volwt",
"ANC_volwt"    ), check.names=TRUE)
unlink(infile1)
# Fix any interval or ratio columns mistakenly read in as nominal and nominal columns read as numeric or dates read as strings
if (class(dt4$Month)!="factor") dt4$Month<- as.factor(dt4$Month)
if (class(dt4$Year_Month)!="factor") dt4$Year_Month<- as.factor(dt4$Year_Month)
if (class(dt4$flow_mm)=="factor") dt4$flow_mm <-as.numeric(levels(dt4$flow_mm))[as.integer(dt4$flow_mm) ]
if (class(dt4$flow_mm)=="character") dt4$flow_mm <-as.numeric(dt4$flow_mm)
if (class(dt4$Ca_flux)=="factor") dt4$Ca_flux <-as.numeric(levels(dt4$Ca_flux))[as.integer(dt4$Ca_flux) ]
if (class(dt4$Ca_flux)=="character") dt4$Ca_flux <-as.numeric(dt4$Ca_flux)
# Convert Missing Values to NA for non-dates
dt4$flow_mm <- ifelse((trimws(as.character(dt4$flow_mm))==trimws("-888.88")),NA,dt4$flow_mm)
suppressWarnings(dt4$flow_mm <- ifelse(!is.na(as.numeric("-888.88")) & (trimws(as.character(dt4$flow_mm))==as.character(as.numeric("-888.88"))),NA,dt4$flow_mm))
dt4$Ca_flux <- ifelse((trimws(as.character(dt4$Ca_flux))==trimws("-888.88")),NA,dt4$Ca_flux)
suppressWarnings(dt4$Ca_flux <- ifelse(!is.na(as.numeric("-888.88")) & (trimws(as.character(dt4$Ca_flux))==as.character(as.numeric("-888.88"))),NA,dt4$Ca_flux))
# conduct data formatting
dt4$DATE<-paste0(dt4$Year_Month,"-01")
dt4$DATE<-ymd(dt4$DATE) # change how R interprets Date to be a date
# add in water year
w.year <- as.numeric(format(dt4$DATE, "%Y"))
june.july.sept <- as.numeric(format(dt4$DATE, "%m")) < 6
w.year[june.july.sept] <- w.year[june.july.sept] - 1
dt4$wyear<-w.year
# make sure you are only using complete years for the record
monchem<-as.data.frame(table( dt4$wyear))
monchem$wys<- paste(monchem$Var1)
monchem[monchem$Freq<12, "Use"]<-"incomplete wyear" # incomplete is less then 12 months
monchem[is.na(monchem$Use),"Use"]<-"complete"
dt4$Use<-monchem$Use[match(dt4$wyear, monchem$wys)]
dt4.complete<-dt4[dt4$Use=="complete",]
# Sum the 12 months to get annual totals
## Ca is in g/ha
annCa_str_WS6<-aggregate(list(Ca.g.ha=dt4.complete$Ca_flux), by=list(wyear=dt4.complete$wyear), FUN="sum")
# has Ca flux from WS6 changed since the 1960s?
gca1<-ggplot(annCa_str_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Reference WS6: annual flux of Ca ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g/ha)")
pca1<-ggplotly(gca1)
pca1
pca1
# make sure you are only using complete years for the record
monchem<-as.data.frame(table( dt4$wyear))
monchem$wys<- paste(monchem$Var1)
monchem[monchem$Freq<12, "Use"]<-"incomplete wyear" # incomplete is less then 12 months
monchem[is.na(monchem$Use),"Use"]<-"complete"
monchem
dt4$Use<-monchem$Use[match(dt4$wyear, monchem$wys)]
dt4.complete<-dt4[dt4$Use=="complete",]
# Sum the 12 months to get annual totals
## Ca is in g/ha
annCa_str_WS6<-aggregate(list(Ca.g.ha=dt4.complete$Ca_flux), by=list(wyear=dt4.complete$wyear), FUN="sum")
# has Ca flux from WS6 changed since the 1960s?
gca1<-ggplot(annCa_str_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Reference WS6: annual flux of Ca ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g/ha)")
pca1<-ggplotly(gca1)
pca1
## Chapter 3.2
####################################################
## read in monthly flux of stream chemistry for WS2
# Package ID: knb-lter-hbr.4.17 Cataloging System:https://pasta.edirepository.org.
# Data set title: Hubbard Brook Experimental Forest: Chemistry of Streamwater â Monthly Fluxes, Watershed 2, 1963 - present.
# Data set creator:    - Hubbard Brook Watershed Ecosystem Record (HBWatER)
# Contact:    -  Hubbard Brook Ecosystem Study  - hbr-im@lternet.edu
# Stylesheet v2.11 for metadata conversion into program: John H. Porter, Univ. Virginia, jporter@virginia.edu
inUrl1  <- "https://pasta.lternet.edu/package/data/eml/knb-lter-hbr/4/17/a6aeef15070be913ee2f06f431b9b7a7"
infile1 <- tempfile()
try(download.file(inUrl1,infile1,method="curl"))
if (is.na(file.size(infile1))) download.file(inUrl1,infile1,method="auto")
dt5 <-read.csv(infile1,header=F
,skip=1
,sep=","
,quot='"'
, col.names=c(
"Year",
"Month",
"Year_Month",
"flow_mm",
"Ca_flux",
"Mg_flux",
"K_flux",
"Na_flux",
"Al_Ferron_flux",
"TMAl_flux",
"OMAl_flux",
"Al_ICP_flux",
"NH4_flux",
"SO4_flux",
"NO3_flux",
"Cl_flux",
"PO4_flux",
"DOC_flux",
"TDN_flux",
"DON_flux",
"DIC_flux",
"SiO2_flux",
"Mn_flux",
"Fe_flux",
"F_flux",
"H_flux",
"pH_volwt",
"SpecCond_volwt",
"ANC_volwt"    ), check.names=TRUE)
unlink(infile1)
# Fix any interval or ratio columns mistakenly read in as nominal and nominal columns read as numeric or dates read as strings
if (class(dt5$Month)!="factor") dt5$Month<- as.factor(dt5$Month)
if (class(dt5$Year_Month)!="factor") dt5$Year_Month<- as.factor(dt5$Year_Month)
if (class(dt5$flow_mm)=="factor") dt5$flow_mm <-as.numeric(levels(dt5$flow_mm))[as.integer(dt5$flow_mm) ]
if (class(dt5$flow_mm)=="character") dt5$flow_mm <-as.numeric(dt5$flow_mm)
if (class(dt5$Ca_flux)=="factor") dt5$Ca_flux <-as.numeric(levels(dt5$Ca_flux))[as.integer(dt5$Ca_flux) ]
if (class(dt5$Ca_flux)=="character") dt5$Ca_flux <-as.numeric(dt5$Ca_flux)
# Convert Missing Values to NA for non-dates
dt5$flow_mm <- ifelse((trimws(as.character(dt5$flow_mm))==trimws("-888.88")),NA,dt5$flow_mm)
suppressWarnings(dt5$flow_mm <- ifelse(!is.na(as.numeric("-888.88")) & (trimws(as.character(dt5$flow_mm))==as.character(as.numeric("-888.88"))),NA,dt5$flow_mm))
dt5$Ca_flux <- ifelse((trimws(as.character(dt5$Ca_flux))==trimws("-888.88")),NA,dt5$Ca_flux)
suppressWarnings(dt5$Ca_flux <- ifelse(!is.na(as.numeric("-888.88")) & (trimws(as.character(dt5$Ca_flux))==as.character(as.numeric("-888.88"))),NA,dt5$Ca_flux))
# Here is the structure of the input data frame:
#str(dt5)
# conduct data formatting
#head(dt5)
dt5$DATE<-paste0(dt5$Year_Month,"-01")
dt5$DATE<-ymd(dt5$DATE) # change how R interprets Date to be a date
# add in water year
w.year <- as.numeric(format(dt5$DATE, "%Y"))
june.july.sept <- as.numeric(format(dt5$DATE, "%m")) < 6
w.year[june.july.sept] <- w.year[june.july.sept] - 1
dt5$wyear<-w.year
# make sure you are only using complete years for the record
monchem<-as.data.frame(table( dt5$wyear))
monchem$wys<- paste(monchem$Var1)
monchem[monchem$Freq<12, "Use"]<-"incomplete wyear" # incomplete is less then 12 months
monchem[is.na(monchem$Use),"Use"]<-"complete"
#head(monchem, 50)
dt5$Use<-monchem$Use[match(dt5$wyear, monchem$wys)]
dt5.complete<-dt5[dt5$Use=="complete",]
head(dt5)
# Sum the 12 months to get annual totals
## Ca is in g/ha
annCa_str_WS2<-aggregate(list(Ca.g.ha=dt5.complete$Ca_flux), by=list(wyear=dt5.complete$wyear), FUN="sum")
#head(annCa_str_WS6)
# Combine WS6 and WS2
annCa_str_WS2$Watershed<-"WS2"
annCa_str_WS6$Watershed<-"WS6"
annCa_str_26<-rbind(annCa_str_WS6,annCa_str_WS2)
# has Ca flux from WS6 changed since the 1960s?
gca2<-ggplot(annCa_str_26, aes(x=wyear, y=Ca.g.ha, col=Watershed))+geom_point()+geom_line(size=1)+
ggtitle("WS2 had higher streamwater Ca compared to reference WS6 after devegetation ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g/ha)")+
geom_vline(xintercept=1965, linetype="dashed", col="red")+
geom_vline(xintercept=1968, linetype="solid", col="red")+
scale_y_log10()
pca2<-ggplotly(gca2)
pca2
## Chapter 4.1
####################################################
# read in chemistry of precipitation for W6
# Package ID: knb-lter-hbr.20.11 Cataloging System:https://pasta.edirepository.org.
# Data set title: Hubbard Brook Experimental Forest: Chemistry of Precipitation  Monthly Fluxes, Watershed 6, 1964 - present.
inUrl1  <- "https://pasta.lternet.edu/package/data/eml/knb-lter-hbr/20/11/76b46d5bd60e4912406726ec71610d0a"
infile1 <- tempfile()
try(download.file(inUrl1,infile1,method="curl"))
if (is.na(file.size(infile1))) download.file(inUrl1,infile1,method="auto")
dt6 <-read.csv(infile1,header=F
,skip=1
,sep=","
,quot='"'
, col.names=c(
"Year",
"Month",
"Year_Month",
"precip_mm",
"Ca_flux",
"Mg_flux",
"K_flux",
"Na_flux",
"Al_Ferron_flux",
"TMAl_flux",
"OMAl_flux",
"Al_ICP_flux",
"NH4_flux",
"SO4_flux",
"NO3_flux",
"Cl_flux",
"PO4_flux",
"DOC_flux",
"TDN_flux",
"DON_flux",
"SiO2_flux",
"Mn_flux",
"Fe_flux",
"F_flux",
"H_flux",
"pH_volwt",
"SpecCond_volwt"    ), check.names=TRUE)
unlink(infile1)
# Fix any interval or ratio columns mistakenly read in as nominal and nominal columns read as numeric or dates read as strings
if (class(dt6$Month)!="factor") dt6$Month<- as.factor(dt6$Month)
if (class(dt6$Year_Month)!="factor") dt6$Year_Month<- as.factor(dt6$Year_Month)
if (class(dt6$precip_mm)=="factor") dt6$precip_mm <-as.numeric(levels(dt6$precip_mm))[as.integer(dt6$precip_mm) ]
if (class(dt6$precip_mm)=="character") dt6$precip_mm <-as.numeric(dt6$precip_mm)
if (class(dt6$Ca_flux)=="factor") dt6$Ca_flux <-as.numeric(levels(dt6$Ca_flux))[as.integer(dt6$Ca_flux) ]
if (class(dt6$Ca_flux)=="character") dt6$Ca_flux <-as.numeric(dt6$Ca_flux)
# Convert Missing Values to NA for non-dates
dt6$precip_mm <- ifelse((trimws(as.character(dt6$precip_mm))==trimws("-888.88")),NA,dt6$precip_mm)
dt6$Ca_flux <- ifelse((trimws(as.character(dt6$Ca_flux))==trimws("-888.88")),NA,dt6$Ca_flux)
# add in date
dt6$DATE<-paste0(dt6$Year_Month,"-01")  # in in day to year month string
dt6$DATE<-ymd(dt6$DATE) # change how R interprets Date to be a date
# add in water year
w.year <- as.numeric(format(dt6$DATE, "%Y"))
june.july.sept <- as.numeric(format(dt6$DATE, "%m")) < 6
w.year[june.july.sept] <- w.year[june.july.sept] - 1
dt6$wyear<-w.year
# make sure you are only using complete years for the record
monchem<-as.data.frame(table( dt6$wyear))
monchem$wys<- paste(monchem$Var1)
monchem[monchem$Freq<10, "Use"]<-"incomplete wyear" # incomplete is less then 12 months
monchem[is.na(monchem$Use),"Use"]<-"complete"
dt6$Use<-monchem$Use[match(dt6$wyear, monchem$wys)]
dt6.complete<-dt6[dt6$Use=="complete",]
# calculate annual input of Ca into WS6
# Sum the 12 months to get annual totals
## Ca is in g/ha
annCa_precip_WS6<-aggregate(list(Ca.g.ha=dt6.complete$Ca_flux, precip_mm=dt6.complete$precip_mm), by=list(wyear=dt6.complete$wyear), FUN="sum")
annCa_precip_WS6$Watershed<-"WS6"  # add watershed ID
annCa_precip_WS6$stream_Ca.g.ha<-annCa_str_WS6$Ca.g.ha[match(annCa_precip_WS6$wyear, annCa_str_WS6$wyear)]
ginputca1<-ggplot(annCa_precip_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Input of Ca to WS6 from precipitation has decreased since the 1960s. ")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g / ha)")
pinputca1<-ggplotly(ginputca1)
pinputca1
## Chapter 5.1
####################################################
# read in vegetation data for WS6 (received from Mary Martin 2022-06-29 by email)
dt7<-read.csv("C:\\Users\\bears\\Downloads\\HubbardBrookWS6_Tree_Biomass_1997.csv")
# Here is the structure of the input data frame:
str(dt7)
tr<-aggregate( list(ABOVE.kg=dt7$ABOVE.kg , BELOW.kg=dt7$BELOW.kg), by=list(Plot=dt7$Plot, Species=dt7$SppName), FUN="sum", na.rm=T)
dim(tr)
head(tr)
biosp<-ggplot(tr, aes(x=BELOW.kg, y=ABOVE.kg, col=Species))+geom_point()+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Belowground biomass (kg)")+
ylab("Aboveground biomass (kg")
ggplotly(biosp)
# gather above and below to make summing trees found in the watershed easier
trg<-gather(tr, "abe","value", 3:4)
#head(trg)
sum(trg$value) # this is the biomass of the entire region?
## I see a sum of 2,969,392 kg of biomass in W6 in 1997
## divide the biomass total by the watershed area to get a kg/ha value
w6biomass.kg.ha<-sum(trg$value) / 13.2  # kg of biomass per hectare
w6biomass.g.m2<- w6biomass.kg.ha * 1000 / 10000
w6biomass.g.m2
## I see a sum of 22,495 g/m2 of biomass in 1997
# The chapter says the value was 16,107 g/m2 in 1964
# biomass was higher in 1997 compared to 64.
# for every gram of tree, there is 3.13 mg of Ca,  based on dry weight.
w6ca.g.m2<-w6biomass.g.m2 * 0.00313 # grams Ca per gram of wood
w6ca.g.m2
# I see 70.4 mg/g of Ca in the biomass
# has Ca flux from WS6 changed since the 1960s?
gca1<-ggplot(annCa_str_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Annual export of Ca in streamwater from WS6")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g/ha)")
pca1<-ggplotly(gca1)
pca1
pca1
ginputca1<-ggplot(annCa_precip_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Annual input of Ca by precipitation for WS6 has decreased")+xlim(1964,2020)+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g / ha)")
pinputca1<-ggplotly(ginputca1)
pinputca1
# has Ca flux from WS6 changed since the 1960s?
gca1<-ggplot(annCa_str_WS6, aes(x=wyear, y=Ca.g.ha))+geom_point()+geom_line()+
ggtitle("Annual export of Ca in streamwater from WS6 has decreased")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Water year (June 1)")+
ylab("Ca (g/ha)")
pca1
stpe
annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","stream_ca.g.ha"]
annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","stream_Ca.g.ha"]
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")
stpe<-ggplotly(strpre)
stpe
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")+scale_fill_manual('Water year (June 1)')
stpe<-ggplotly(strpre)
stpe
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")+slabs(fill='Program Type')
stpe<-ggplotly(strpre)
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")+labs(fill='Program Type')
stpe<-ggplotly(strpre)
stpe
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")+labs(col='Program Type')
stpe<-ggplotly(strpre)
stpe
stpe
strpre<-ggplot(annCa_precip_WS6, aes(x=stream_Ca.g.ha, y=Ca.g.ha, col=wyear, group=wyear))+geom_point()+
ggtitle(" ")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
xlab("Export of Ca by Streamwater (g/ha/year)")+
ylab("Input pf Ca by Precipitation (g/ha/year)")+labs(col='Water year (June 1)')
stpe<-ggplotly(strpre)
stpe
annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","stream_Ca.g.ha"]
annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","stream_Ca.g.ha"]
annCa_precip_WS6[annCa_precip_WS6$wyear=="1997","stream_Ca.g.ha"]
w6ca.g.m2
w6ca.g.m2
w6ca.g.ha<-w6ca.g.m2 * 10000
w6ca.g.ha
w6ca_str_65<-annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","stream_Ca.g.ha"]
w6ca_str_97<-annCa_precip_WS6[annCa_precip_WS6$wyear=="1997","stream_Ca.g.ha"]
w6ca_pre_65<-annCa_precip_WS6[annCa_precip_WS6$wyear=="1965","Ca.g.ha"]
w6ca_pre_97<-annCa_precip_WS6[annCa_precip_WS6$wyear=="1997","Ca.g.ha"]
# compare to Ca g/m2  , previously calculated as w6ca.g.m2
w6ca_wood.g.ha<-w6ca.g.m2 * 10000
w6ca.g.m2
w6ca_wood.g.ha_64<- 50.7 * 10000
# compare to Ca g/m2  , previously calculated as w6ca.g.m2
w6ca_wood.g.ha_65<- 50.7 * 10000
w6ca_wood.g.ha_97<-w6ca.g.m2 * 10000
hb<-data.frame( Year=c("1965","1997","1965","1997","1965","1997" ),
Pool=c("stream export","stream export","precip input","precip input","biomass","biomass" ),
value=c(w6ca_str_65,w6ca_str_97, w6ca_pre_65, w6ca_pre_97, w6ca_wood.g.ha_65, w6ca_wood.g.ha_97 ))
hb
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")
hbw6<-data.frame( Year=c("1965","1997","1965","1997","1965","1997" ),
Pool=c("stream export","stream export","precip input","precip input","biomass","biomass" ),
value=c(w6ca_str_65,w6ca_str_97, w6ca_pre_65, w6ca_pre_97, w6ca_wood.g.ha_65, w6ca_wood.g.ha_97 ))
hbw6
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")
# compare to Ca g/m2  , previously calculated as w6ca.g.m2
w6ca_wood.g.ha_65<- 50.7
w6ca_wood.g.ha_97<-w6ca.g.m2
hbw6<-data.frame( Year=c("1965","1997","1965","1997","1965","1997" ),
Pool=c("stream export","stream export","precip input","precip input","biomass","biomass" ),
value=c(w6ca_str_65,w6ca_str_97, w6ca_pre_65, w6ca_pre_97, w6ca_wood.g.ha_65, w6ca_wood.g.ha_97 ))
hbw6
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")
# compare to Ca g/m2  , previously calculated as w6ca.g.m2
w6ca_wood.g.ha_65<- 50.7 * 10000
w6ca_wood.g.ha_97<-w6ca.g.m2 * 10000
hbw6<-data.frame( Year=c("1965","1997","1965","1997","1965","1997" ),
Pool=c("stream export","stream export","precip input","precip input","biomass","biomass" ),
value=c(w6ca_str_65,w6ca_str_97, w6ca_pre_65, w6ca_pre_97, w6ca_wood.g.ha_65, w6ca_wood.g.ha_97 ))
hbw6
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")+
scale_y_log10()
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")+
theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_y_log10()+labs(col='Water year (June 1)')
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge")+
theme_classic()+
scale_y_log10()+labs(col='Water year (June 1)')
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge", col="black")+
theme_classic()+
scale_y_log10()+labs(col='Water year (June 1)')
hbw6$Pool<-factor(hbw6$Pool, levels=c("precip input","stream export","biomass"))
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge", col="black")+
theme_classic()+ylab("Ca (g/ha/year)")+
scale_y_log10()+labs(col='Water year (June 1)')
ggplot(hbw6, aes(x=Pool, y=value, fill=Year))+geom_bar(stat="identity",position="dodge", col="black")+
theme_classic()+ylab("Ca (g / ha / year)")+
scale_y_log10()+labs(col='Water year (June 1)')
